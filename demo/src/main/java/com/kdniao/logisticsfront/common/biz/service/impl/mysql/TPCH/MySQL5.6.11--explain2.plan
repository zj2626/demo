mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:42     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q1' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  L_RETURNFLAG,
    ->  L_LINESTATUS,
    ->  SUM(L_QUANTITY) AS SUM_QTY,
    ->  SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
    ->  SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS SUM_DISC_PRICE,
    ->  SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) * (1 + L_TAX)) AS SUM_CHARGE,
    ->  AVG(L_QUANTITY) AS AVG_QTY,
    ->  AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
    ->  AVG(L_DISCOUNT) AS AVG_DISC,
    ->  COUNT(*) AS COUNT_ORDER
    -> FROM
    ->  LINEITEM
    -> WHERE
    ->  L_SHIPDATE <= DATE'1998-12-01' - INTERVAL '90' DAY
    -> GROUP BY
    ->  L_RETURNFLAG,
    ->  L_LINESTATUS
    -> ORDER BY
    ->  L_RETURNFLAG,
    ->  L_LINESTATUS;
+----+-------------+----------+------+---------------+------+---------+------+---------+----------+----------------------------------------------+
| id | select_type | table    | type | possible_keys | key  | key_len | ref  | rows    | filtered | Extra                                        |
+----+-------------+----------+------+---------------+------+---------+------+---------+----------+----------------------------------------------+
|  1 | SIMPLE      | LINEITEM | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 5947760 |    50.00 | Using where; Using temporary; Using filesort |
+----+-------------+----------+------+---------------+------+---------+------+---------+----------+----------------------------------------------+
1 row in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                       |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`lineitem`.`l_returnflag` AS `L_RETURNFLAG`,`tpch`.`lineitem`.`l_linestatus` AS `L_LINESTATUS`,sum(`tpch`.`lineitem`.`l_quantity`) AS `SUM_QTY`,sum(`tpch`.`lineitem`.`l_extendedprice`) AS `SUM_BASE_PRICE`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `SUM_DISC_PRIC
E`,sum(((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) * (1 + `tpch`.`lineitem`.`l_tax`))) AS `SUM_CHARGE`,avg(`tpch`.`lineitem`.`l_quantity`) AS `AVG_QTY`,avg(`tpch`.`lineitem`.`l_extendedprice`) AS `AVG_PRICE`,avg(`tpch`.`lineitem`.`l_discount`) AS `AVG_DISC`,count(0) AS `COUNT_ORDER` from `tpch`.`lineitem` where (`t
pch`.`lineitem`.`l_shipDATE` <= <cache>((DATE'1998-12-01' - interval '90' day))) group by `tpch`.`lineitem`.`l_returnflag`,`tpch`.`lineitem`.`l_linestatus` order by `tpch`.`lineitem`.`l_returnflag`,`tpch`.`lineitem`.`l_linestatus` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:42     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q2;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q2' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  S_ACCTBAL,
    ->  S_NAME,
    ->  N_NAME,
    ->  P_PARTKEY,
    ->  P_MFGR,
    ->  S_ADDRESS,
    ->  S_PHONE,
    ->  S_COMMENT
    -> FROM
    ->  PART,
    ->  SUPPLIER,
    ->  PARTSUPP,
    ->  NATION,
    ->  REGION
    -> WHERE
    ->  P_PARTKEY = PS_PARTKEY
    ->  AND S_SUPPKEY = PS_SUPPKEY
    ->  AND P_SIZE = 15
    ->  AND P_TYPE LIKE '%BRASS'
    ->  AND S_NATIONKEY = N_NATIONKEY
    ->  AND N_REGIONKEY = R_REGIONKEY
    ->  AND R_NAME = 'EUROPE'
    ->  AND PS_SUPPLYCOST = (
    ->          SELECT
    ->                  MIN(PS_SUPPLYCOST)
    ->          FROM
    ->                  PARTSUPP, SUPPLIER,
    ->                  NATION, REGION
    ->          WHERE
    ->                  P_PARTKEY = PS_PARTKEY
    ->                  AND S_SUPPKEY = PS_SUPPKEY
    ->                  AND S_NATIONKEY = N_NATIONKEY
    ->                  AND N_REGIONKEY = R_REGIONKEY
    ->                  AND R_NAME = 'EUROPE' )
    -> ORDER BY
    ->  S_ACCTBAL DESC,
    ->  N_NAME,
    ->  S_NAME,
    ->  P_PARTKEY;
+----+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+------+----------+----------------------------------------------+
| id | select_type        | table    | type   | possible_keys                     | key           | key_len | ref                       | rows | filtered | Extra                                        |
+----+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+------+----------+----------------------------------------------+
|  1 | PRIMARY            | REGION   | ALL    | PRIMARY                           | NULL          | NULL    | NULL                      |    5 |   100.00 | Using where; Using temporary; Using filesort |
|  1 | PRIMARY            | NATION   | ref    | PRIMARY,i_n_regionkey             | i_n_regionkey | 5       | tpch.REGION.r_regionkey   |    2 |   100.00 | NULL                                         |
|  1 | PRIMARY            | SUPPLIER | ref    | PRIMARY,i_s_nationkey             | i_s_nationkey | 5       | tpch.NATION.n_nationkey   |  199 |   100.00 | NULL                                         |
|  1 | PRIMARY            | PARTSUPP | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | i_ps_suppkey  | 4       | tpch.SUPPLIER.s_suppkey   |   39 |   100.00 | NULL                                         |
|  1 | PRIMARY            | PART     | eq_ref | PRIMARY                           | PRIMARY       | 4       | tpch.PARTSUPP.ps_partkey  |    1 |   100.00 | Using where                                  |
|  2 | DEPENDENT SUBQUERY | PARTSUPP | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | PRIMARY       | 4       | tpch.PART.p_partkey       |    1 |   100.00 | NULL                                         |
|  2 | DEPENDENT SUBQUERY | SUPPLIER | eq_ref | PRIMARY,i_s_nationkey             | PRIMARY       | 4       | tpch.PARTSUPP.ps_suppkey  |    1 |   100.00 | Using where                                  |
|  2 | DEPENDENT SUBQUERY | NATION   | eq_ref | PRIMARY,i_n_regionkey             | PRIMARY       | 4       | tpch.SUPPLIER.s_nationkey |    1 |   100.00 | Using where                                  |
|  2 | DEPENDENT SUBQUERY | REGION   | eq_ref | PRIMARY                           | PRIMARY       | 4       | tpch.NATION.n_regionkey   |    1 |   100.00 | Using where                                  |
+----+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+------+----------+----------------------------------------------+
9 rows in set, 2 warnings (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------+
| Note  | 1276 | Field or reference 'tpch.PART.p_partkey' of SELECT #2 was resolved in SELECT #1

                                                                                                                                                                                                                                                                                                                                                      |
| Note  | 1003 | /* select#1 */ select `tpch`.`supplier`.`s_acctbal` AS `S_ACCTBAL`,`tpch`.`supplier`.`s_name` AS `S_NAME`,`tpch`.`nation`.`n_name` AS `N_NAME`,`tpch`.`part`.`p_partkey` AS `P_PARTKEY`,`tpch`.`part`.`p_mfgr` AS `P_MFGR`,`tpch`.`supplier`.`s_address` AS `S_ADDRESS`,`tpch`.`supplier`.`s_phone` AS `S_PHONE`,`tpch`.`supplier`.`s_comment
` AS `S_COMMENT` from `tpch`.`part` join `tpch`.`supplier` join `tpch`.`partsupp` join `tpch`.`nation` join `tpch`.`region` where ((`tpch`.`nation`.`n_regionkey` = `tpch`.`region`.`r_regionkey`) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`part`.`p_size` = 15) and (`tpch`.`partsupp`.`ps_suppkey` = `tpch`.`suppl
ier`.`s_suppkey`) and (`tpch`.`part`.`p_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`part`.`p_type` like '%BRASS') and (`tpch`.`region`.`r_name` = 'EUROPE') and (`tpch`.`partsupp`.`ps_supplycost` = (/* select#2 */ select min(`tpch`.`partsupp`.`ps_supplycost`) from `tpch`.`partsupp` join `tpch`.`supplier` join `tpch`.`nation` join `tpch`.
`region` where ((`tpch`.`region`.`r_regionkey` = `tpch`.`nation`.`n_regionkey`) and (`tpch`.`nation`.`n_nationkey` = `tpch`.`supplier`.`s_nationkey`) and (`tpch`.`supplier`.`s_suppkey` = `tpch`.`partsupp`.`ps_suppkey`) and (`tpch`.`part`.`p_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`region`.`r_name` = 'EUROPE'))))) order by `tpch`.`sup
plier`.`s_acctbal` desc,`tpch`.`nation`.`n_name`,`tpch`.`supplier`.`s_name`,`tpch`.`part`.`p_partkey` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:42     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q3;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q3' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  L_ORDERKEY,
    ->  SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
    ->  O_ORDERDATE,
    ->  O_SHIPPRIORITY
    -> FROM
    ->  CUSTOMER,
    ->  ORDERS,
    ->  LINEITEM
    -> WHERE
    ->  C_MKTSEGMENT = 'BUILDING'
    ->  AND C_CUSTKEY = O_CUSTKEY
    ->  AND L_ORDERKEY = O_ORDERKEY
    ->  AND O_ORDERDATE < DATE '1995-03-15'
    ->  AND L_SHIPDATE > DATE '1995-03-15'
    -> GROUP BY
    ->  L_ORDERKEY,
    ->  O_ORDERDATE,
    ->  O_SHIPPRIORITY
    -> ORDER BY
    ->  REVENUE DESC,
    ->  O_ORDERDATE;
+----+-------------+----------+--------+-------------------------------------------------+--------------+---------+------------------------+---------+----------+----------------------------------------------+
| id | select_type | table    | type   | possible_keys                                   | key          | key_len | ref                    | rows    | filtered | Extra                                        |
+----+-------------+----------+--------+-------------------------------------------------+--------------+---------+------------------------+---------+----------+----------------------------------------------+
|  1 | SIMPLE      | ORDERS   | ALL    | PRIMARY,i_o_orderdate,i_o_custkey               | NULL         | NULL    | NULL                   | 1491317 |    50.00 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | CUSTOMER | eq_ref | PRIMARY                                         | PRIMARY      | 4       | tpch.ORDERS.o_custkey  |       1 |   100.00 | Using where                                  |
|  1 | SIMPLE      | LINEITEM | ref    | i_l_shipdate,i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey | 5       | tpch.ORDERS.o_orderkey |       1 |   100.00 | Using where                                  |
+----+-------------+----------+--------+-------------------------------------------------+--------------+---------+------------------------+---------+----------+----------------------------------------------+
3 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                          |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`lineitem`.`l_orderkey` AS `L_ORDERKEY`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `REVENUE`,`tpch`.`orders`.`o_orderDATE` AS `O_ORDERDATE`,`tpch`.`orders`.`o_shippriority` AS `O_SHIPPRIORITY` from `tpch`.`customer` join `tpch`.`orders` join `tpch`.`lineitem` wh
ere ((`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`customer`.`c_custkey` = `tpch`.`orders`.`o_custkey`) and (`tpch`.`customer`.`c_mktsegment` = 'BUILDING') and (`tpch`.`orders`.`o_orderDATE` < DATE'1995-03-15') and (`tpch`.`lineitem`.`l_shipDATE` > DATE'1995-03-15')) group by `tpch`.`lineitem`.`l_orderkey`,`tpch`.`ord
ers`.`o_orderDATE`,`tpch`.`orders`.`o_shippriority` order by `REVENUE` desc,`tpch`.`orders`.`o_orderDATE` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:43     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q4;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q4' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  O_ORDERPRIORITY,
    ->  COUNT(*) AS ORDER_COUNT
    -> FROM
    ->  ORDERS
    -> WHERE
    ->  O_ORDERDATE >= DATE '1993-07-01'
    ->  AND O_ORDERDATE < DATE '1993-07-01' + INTERVAL '3' MONTH
    ->  AND EXISTS (
    ->          SELECT
    ->                  *
    ->          FROM
    ->                  LINEITEM
    ->          WHERE
    ->                  L_ORDERKEY = O_ORDERKEY
    ->                  AND L_COMMITDATE < L_RECEIPTDATE
    ->          )
    -> GROUP BY
    ->  O_ORDERPRIORITY
    -> ORDER BY
    ->  O_ORDERPRIORITY;
+----+--------------------+----------+-------+------------------------------------+---------------+---------+------------------------+--------+----------+--------------------------------------------------------------------------------+
| id | select_type        | table    | type  | possible_keys                      | key           | key_len | ref                    | rows   | filtered | Extra                                                                          |
+----+--------------------+----------+-------+------------------------------------+---------------+---------+------------------------+--------+----------+--------------------------------------------------------------------------------+
|  1 | PRIMARY            | ORDERS   | range | i_o_orderdate                      | i_o_orderdate | 4       | NULL                   | 110418 |   100.00 | Using index condition; Using where; Using MRR; Using temporary; Using filesort |
|  2 | DEPENDENT SUBQUERY | LINEITEM | ref   | i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey  | 5       | tpch.ORDERS.o_orderkey |      1 |   100.00 | Using where                                                                    |
+----+--------------------+----------+-------+------------------------------------+---------------+---------+------------------------+--------+----------+--------------------------------------------------------------------------------+
2 rows in set, 2 warnings (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message
                                                                                                                                                                                                                             |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1276 | Field or reference 'tpch.ORDERS.o_orderkey' of SELECT #2 was resolved in SELECT #1
                                                                                                                                                                                                                             |
| Note  | 1003 | /* select#1 */ select `tpch`.`orders`.`o_orderpriority` AS `O_ORDERPRIORITY`,count(0) AS `ORDER_COUNT` from `tpch`.`orders` where ((`tpch`.`orders`.`o_orderDATE` >= DATE'1993-07-01') and (`tpch`.`orders`.`o_orderDATE` < (DATE'1993-07-01' + interval '3' month)) and exists(/* select#2 */ select 1 from `tpch`.`lineitem` where ((`tpch`
.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`lineitem`.`l_commitDATE` < `tpch`.`lineitem`.`l_receiptDATE`)))) group by `tpch`.`orders`.`o_orderpriority` order by `tpch`.`orders`.`o_orderpriority` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:43     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q5;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q5' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  N_NAME,
    ->  SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE
    -> FROM
    ->  CUSTOMER,
    ->  ORDERS,
    ->  LINEITEM,
    ->  SUPPLIER,
    ->  NATION,
    ->  REGION
    -> WHERE
    ->  C_CUSTKEY = O_CUSTKEY
    ->  AND L_ORDERKEY = O_ORDERKEY
    ->  AND L_SUPPKEY = S_SUPPKEY
    ->  AND C_NATIONKEY = S_NATIONKEY
    ->  AND S_NATIONKEY = N_NATIONKEY
    ->  AND N_REGIONKEY = R_REGIONKEY
    ->  AND R_NAME = 'ASIA'
    ->  AND O_ORDERDATE >= DATE '1994-01-01'
    ->  AND O_ORDERDATE < DATE '1994-01-01' + INTERVAL '1' YEAR
    -> GROUP BY
    ->  N_NAME
    -> ORDER BY
    ->  REVENUE DESC;
+----+-------------+----------+--------+------------------------------------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
| id | select_type | table    | type   | possible_keys                                  | key           | key_len | ref                     | rows | filtered | Extra                                        |
+----+-------------+----------+--------+------------------------------------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
|  1 | SIMPLE      | REGION   | ALL    | PRIMARY                                        | NULL          | NULL    | NULL                    |    5 |   100.00 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | NATION   | ref    | PRIMARY,i_n_regionkey                          | i_n_regionkey | 5       | tpch.REGION.r_regionkey |    2 |   100.00 | NULL                                         |
|  1 | SIMPLE      | CUSTOMER | ref    | PRIMARY,i_c_nationkey                          | i_c_nationkey | 5       | tpch.NATION.n_nationkey | 3105 |   100.00 | Using index                                  |
|  1 | SIMPLE      | ORDERS   | ref    | PRIMARY,i_o_orderdate,i_o_custkey              | i_o_custkey   | 5       | tpch.CUSTOMER.c_custkey |    7 |   100.00 | Using where                                  |
|  1 | SIMPLE      | LINEITEM | ref    | i_l_orderkey,i_l_suppkey,i_l_orderkey_quantity | i_l_orderkey  | 5       | tpch.ORDERS.o_orderkey  |    1 |   100.00 | Using where                                  |
|  1 | SIMPLE      | SUPPLIER | eq_ref | PRIMARY,i_s_nationkey                          | PRIMARY       | 4       | tpch.LINEITEM.l_suppkey |    1 |   100.00 | Using where                                  |
+----+-------------+----------+--------+------------------------------------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
6 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                 |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`nation`.`n_name` AS `N_NAME`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `REVENUE` from `tpch`.`customer` join `tpch`.`orders` join `tpch`.`lineitem` join `tpch`.`supplier` join `tpch`.`nation` join `tpch`.`region` where ((`tpch`.`nation`.`n_regionkey` = `tpch`.
`region`.`r_regionkey`) and (`tpch`.`customer`.`c_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`supplier`.`s_suppkey` = `tpch`.`lineitem`.`l_suppkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`orders`.`o_custkey` = `tpch`.`custome
r`.`c_custkey`) and (`tpch`.`region`.`r_name` = 'ASIA') and (`tpch`.`orders`.`o_orderDATE` >= DATE'1994-01-01') and (`tpch`.`orders`.`o_orderDATE` < <cache>((DATE'1994-01-01' + interval '1' year)))) group by `tpch`.`nation`.`n_name` order by `REVENUE` desc |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:43     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q6;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q6' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  SUM(L_EXTENDEDPRICE * L_DISCOUNT) AS REVENUE
    -> FROM
    ->  LINEITEM
    -> WHERE
    ->  L_SHIPDATE >= DATE '1994-01-01'
    ->  AND L_SHIPDATE < DATE '1994-01-01' + INTERVAL '1' YEAR
    ->  AND L_DISCOUNT BETWEEN 0.06 - 0.01 AND 0.06 + 0.01
    ->  AND L_QUANTITY < 24;
+----+-------------+----------+------+---------------+------+---------+------+---------+----------+-------------+
| id | select_type | table    | type | possible_keys | key  | key_len | ref  | rows    | filtered | Extra       |
+----+-------------+----------+------+---------------+------+---------+------+---------+----------+-------------+
|  1 | SIMPLE      | LINEITEM | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 5947760 |    29.94 | Using where |
+----+-------------+----------+------+---------------+------+---------+------+---------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------+
| Level | Code | Message
                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select sum((`tpch`.`lineitem`.`l_extendedprice` * `tpch`.`lineitem`.`l_discount`)) AS `REVENUE` from `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_shipDATE` >= DATE'1994-01-01') and (`tpch`.`lineitem`.`l_shipDATE` < <cache>((DATE'1994-01-01' + interval '1' year))) and (`tpch`.`lineitem`.`l_discount` between <cache>(
(0.06 - 0.01)) and <cache>((0.06 + 0.01))) and (`tpch`.`lineitem`.`l_quantity` < 24)) |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:44     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q7;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q7' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  SUPP_NATION,
    ->  CUST_NATION,
    ->  L_YEAR, SUM(VOLUME) AS REVENUE
    -> FROM (
    ->  SELECT
    ->          N1.N_NAME AS SUPP_NATION,
    ->          N2.N_NAME AS CUST_NATION,
    ->          EXTRACT(YEAR FROM L_SHIPDATE) AS L_YEAR,
    ->          L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME
    ->  FROM
    ->          SUPPLIER,
    ->          LINEITEM,
    ->          ORDERS,
    ->          CUSTOMER,
    ->          NATION N1,
    ->          NATION N2
    ->  WHERE
    ->          S_SUPPKEY = L_SUPPKEY
    ->          AND O_ORDERKEY = L_ORDERKEY
    ->          AND C_CUSTKEY = O_CUSTKEY
    ->          AND S_NATIONKEY = N1.N_NATIONKEY
    ->          AND C_NATIONKEY = N2.N_NATIONKEY
    ->          AND (
    ->                  (N1.N_NAME = 'FRANCE' AND N2.N_NAME = 'GERMANY')
    ->                  OR (N1.N_NAME = 'GERMANY' AND N2.N_NAME = 'FRANCE')
    ->          )
    ->          AND L_SHIPDATE BETWEEN DATE '1995-01-01' AND DATE '1996-12-31'
    ->  ) AS SHIPPING
    -> GROUP BY
    ->  SUPP_NATION,
    ->  CUST_NATION,
    ->  L_YEAR
    -> ORDER BY
    ->  SUPP_NATION,
    ->  CUST_NATION,
    ->  L_YEAR;
+----+-------------+------------+--------+-------------------------------------------------------------+---------------+---------+---------------------------+--------+----------+---------------------------------+
| id | select_type | table      | type   | possible_keys                                               | key           | key_len | ref                       | rows   | filtered | Extra                           |
+----+-------------+------------+--------+-------------------------------------------------------------+---------------+---------+---------------------------+--------+----------+---------------------------------+
|  1 | PRIMARY     | <derived2> | ALL    | NULL                                                        | NULL          | NULL    | NULL                      | 543375 |   100.00 | Using temporary; Using filesort |
|  2 | DERIVED     | N2         | ALL    | PRIMARY                                                     | NULL          | NULL    | NULL                      |     25 |   100.00 | Using where                     |
|  2 | DERIVED     | CUSTOMER   | ref    | PRIMARY,i_c_nationkey                                       | i_c_nationkey | 5       | tpch.N2.n_nationkey       |   3105 |   100.00 | Using index                     |
|  2 | DERIVED     | ORDERS     | ref    | PRIMARY,i_o_custkey                                         | i_o_custkey   | 5       | tpch.CUSTOMER.c_custkey   |      7 |   100.00 | Using index                     |
|  2 | DERIVED     | LINEITEM   | ref    | i_l_shipdate,i_l_orderkey,i_l_suppkey,i_l_orderkey_quantity | i_l_orderkey  | 5       | tpch.ORDERS.o_orderkey    |      1 |   100.00 | Using where                     |
|  2 | DERIVED     | SUPPLIER   | eq_ref | PRIMARY,i_s_nationkey                                       | PRIMARY       | 4       | tpch.LINEITEM.l_suppkey   |      1 |   100.00 | Using where                     |
|  2 | DERIVED     | N1         | eq_ref | PRIMARY                                                     | PRIMARY       | 4       | tpch.SUPPLIER.s_nationkey |      1 |   100.00 | Using where                     |
+----+-------------+------------+--------+-------------------------------------------------------------+---------------+---------+---------------------------+--------+----------+---------------------------------+
7 rows in set, 1 warning (0.02 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `shipping`.`SUPP_NATION` AS `SUPP_NATION`,`shipping`.`CUST_NATION` AS `CUST_NATION`,`shipping`.`L_YEAR` AS `L_YEAR`,sum(`shipping`.`VOLUME`) AS `REVENUE` from (/* select#2 */ select `tpch`.`n1`.`n_name` AS `SUPP_NATION`,`tpch`.`n2`.`n_name` AS `CUST_NATION`,extract(year from `tpch`.`lineitem`.`l_shipDATE`) AS
`L_YEAR`,(`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) AS `VOLUME` from `tpch`.`supplier` join `tpch`.`lineitem` join `tpch`.`orders` join `tpch`.`customer` join `tpch`.`nation` `n1` join `tpch`.`nation` `n2` where ((`tpch`.`customer`.`c_nationkey` = `tpch`.`n2`.`n_nationkey`) and (`tpch`.`n1`.`n_nationkey` = `tpch`.`
supplier`.`s_nationkey`) and (`tpch`.`orders`.`o_custkey` = `tpch`.`customer`.`c_custkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`supplier`.`s_suppkey` = `tpch`.`lineitem`.`l_suppkey`) and (((`tpch`.`n1`.`n_name` = 'FRANCE') and (`tpch`.`n2`.`n_name` = 'GERMANY')) or ((`tpch`.`n1`.`n_name` = 'GERMANY') and
(`tpch`.`n2`.`n_name` = 'FRANCE'))) and (`tpch`.`lineitem`.`l_shipDATE` between DATE'1995-01-01' and DATE'1996-12-31'))) `shipping` group by `shipping`.`SUPP_NATION`,`shipping`.`CUST_NATION`,`shipping`.`L_YEAR` order by `shipping`.`SUPP_NATION`,`shipping`.`CUST_NATION`,`shipping`.`L_YEAR` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:44     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q8;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q8' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  O_YEAR,
    ->  SUM(CASE
    ->          WHEN NATION = 'BRAZIL'
    ->          THEN VOLUME
    ->          ELSE 0
    ->  END) / SUM(VOLUME) AS MKT_SHARE
    -> FROM (
    ->  SELECT
    ->          EXTRACT(YEAR FROM O_ORDERDATE) AS O_YEAR,
    ->          L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME,
    ->          N2.N_NAME AS NATION
    ->  FROM
    ->          PART,
    ->          SUPPLIER,
    ->          LINEITEM,
    ->          ORDERS,
    ->          CUSTOMER,
    ->          NATION N1,
    ->          NATION N2,
    ->          REGION
    ->  WHERE
    ->          P_PARTKEY = L_PARTKEY
    ->          AND S_SUPPKEY = L_SUPPKEY
    ->          AND L_ORDERKEY = O_ORDERKEY
    ->          AND O_CUSTKEY = C_CUSTKEY
    ->          AND C_NATIONKEY = N1.N_NATIONKEY
    ->          AND N1.N_REGIONKEY = R_REGIONKEY
    ->          AND R_NAME = 'AMERICA'
    ->          AND S_NATIONKEY = N2.N_NATIONKEY
    ->          AND O_ORDERDATE BETWEEN DATE '1995-01-01' AND DATE '1996-12-31'
    ->          AND P_TYPE = 'ECONOMY ANODIZED STEEL'
    ->  ) AS ALL_NATIONS
    -> GROUP BY
    ->  O_YEAR
    -> ORDER BY
    ->  O_YEAR;
+----+-------------+------------+--------+--------------------------------------------------------------------------------+---------------+---------+---------------------------+--------+----------+---------------------------------+
| id | select_type | table      | type   | possible_keys                                                                  | key           | key_len | ref                       | rows   | filtered | Extra                           |
+----+-------------+------------+--------+--------------------------------------------------------------------------------+---------------+---------+---------------------------+--------+----------+---------------------------------+
|  1 | PRIMARY     | <derived2> | ALL    | NULL                                                                           | NULL          | NULL    | NULL                      | 217350 |   100.00 | Using temporary; Using filesort |
|  2 | DERIVED     | REGION     | ALL    | PRIMARY                                                                        | NULL          | NULL    | NULL                      |      5 |   100.00 | Using where                     |
|  2 | DERIVED     | N1         | ref    | PRIMARY,i_n_regionkey                                                          | i_n_regionkey | 5       | tpch.REGION.r_regionkey   |      2 |   100.00 | Using index                     |
|  2 | DERIVED     | CUSTOMER   | ref    | PRIMARY,i_c_nationkey                                                          | i_c_nationkey | 5       | tpch.N1.n_nationkey       |   3105 |   100.00 | Using index                     |
|  2 | DERIVED     | ORDERS     | ref    | PRIMARY,i_o_orderdate,i_o_custkey                                              | i_o_custkey   | 5       | tpch.CUSTOMER.c_custkey   |      7 |   100.00 | Using where                     |
|  2 | DERIVED     | LINEITEM   | ref    | i_l_partkey,i_l_orderkey,i_l_suppkey_partkey,i_l_suppkey,i_l_orderkey_quantity | i_l_orderkey  | 5       | tpch.ORDERS.o_orderkey    |      1 |   100.00 | Using where                     |
|  2 | DERIVED     | SUPPLIER   | eq_ref | PRIMARY,i_s_nationkey                                                          | PRIMARY       | 4       | tpch.LINEITEM.l_suppkey   |      1 |   100.00 | Using where                     |
|  2 | DERIVED     | N2         | eq_ref | PRIMARY                                                                        | PRIMARY       | 4       | tpch.SUPPLIER.s_nationkey |      1 |   100.00 | NULL                            |
|  2 | DERIVED     | PART       | eq_ref | PRIMARY                                                                        | PRIMARY       | 4       | tpch.LINEITEM.l_partkey   |      1 |   100.00 | Using where                     |
+----+-------------+------------+--------+--------------------------------------------------------------------------------+---------------+---------+---------------------------+--------+----------+---------------------------------+
9 rows in set, 1 warning (0.02 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `all_nations`.`O_YEAR` AS `O_YEAR`,(sum((case when (`all_nations`.`NATION` = 'BRAZIL') then `all_nations`.`VOLUME` else 0 end)) / sum(`all_nations`.`VOLUME`)) AS `MKT_SHARE` from (/* select#2 */ select extract(year from `tpch`.`orders`.`o_orderDATE`) AS `O_YEAR`,(`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpc
h`.`lineitem`.`l_discount`)) AS `VOLUME`,`tpch`.`n2`.`n_name` AS `NATION` from `tpch`.`part` join `tpch`.`supplier` join `tpch`.`lineitem` join `tpch`.`orders` join `tpch`.`customer` join `tpch`.`nation` `n1` join `tpch`.`nation` `n2` join `tpch`.`region` where ((`tpch`.`n2`.`n_nationkey` = `tpch`.`supplier`.`s_nationkey`) and (`tpch`.`n1`.`n_regio
nkey` = `tpch`.`region`.`r_regionkey`) and (`tpch`.`customer`.`c_nationkey` = `tpch`.`n1`.`n_nationkey`) and (`tpch`.`orders`.`o_custkey` = `tpch`.`customer`.`c_custkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`supplier`.`s_suppkey` = `tpch`.`lineitem`.`l_suppkey`) and (`tpch`.`part`.`p_partkey` = `tpch`.`li
neitem`.`l_partkey`) and (`tpch`.`region`.`r_name` = 'AMERICA') and (`tpch`.`orders`.`o_orderDATE` between DATE'1995-01-01' and DATE'1996-12-31') and (`tpch`.`part`.`p_type` = 'ECONOMY ANODIZED STEEL'))) `all_nations` group by `all_nations`.`O_YEAR` order by `all_nations`.`O_YEAR` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:44     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q9;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q9' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  NATION,
    ->  O_YEAR,
    ->  SUM(AMOUNT) AS SUM_PROFIT
    -> FROM (
    ->  SELECT
    ->          N_NAME AS NATION,
    ->          EXTRACT(YEAR FROM O_ORDERDATE) AS O_YEAR,
    ->          L_EXTENDEDPRICE * (1 - L_DISCOUNT) - PS_SUPPLYCOST * L_QUANTITY AS AMOUNT
    ->  FROM
    ->          PART,
    ->          SUPPLIER,
    ->          LINEITEM,
    ->          PARTSUPP,
    ->          ORDERS,
    ->          NATION
    ->  WHERE
    ->          S_SUPPKEY = L_SUPPKEY
    ->          AND PS_SUPPKEY = L_SUPPKEY
    ->          AND PS_PARTKEY = L_PARTKEY
    ->          AND P_PARTKEY = L_PARTKEY
    ->          AND O_ORDERKEY = L_ORDERKEY
    ->          AND S_NATIONKEY = N_NATIONKEY
    ->          AND P_NAME LIKE '%GREEN%'
    ->  ) AS PROFIT
    -> GROUP BY
    ->  NATION,
    ->  O_YEAR
    -> ORDER BY
    ->  NATION,
    ->  O_YEAR DESC;
+----+-------------+------------+--------+--------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+--------+----------+---------------------------------+
| id | select_type | table      | type   | possible_keys                                                                  | key                 | key_len | ref                                              | rows   | filtered | Extra                           |
+----+-------------+------------+--------+--------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+--------+----------+---------------------------------+
|  1 | PRIMARY     | <derived2> | ALL    | NULL                                                                           | NULL                | NULL    | NULL                                             | 582075 |   100.00 | Using temporary; Using filesort |
|  2 | DERIVED     | NATION     | ALL    | PRIMARY                                                                        | NULL                | NULL    | NULL                                             |     25 |   100.00 | NULL                            |
|  2 | DERIVED     | SUPPLIER   | ref    | PRIMARY,i_s_nationkey                                                          | i_s_nationkey       | 5       | tpch.NATION.n_nationkey                          |    199 |   100.00 | Using index                     |
|  2 | DERIVED     | PARTSUPP   | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                                              | i_ps_suppkey        | 4       | tpch.SUPPLIER.s_suppkey                          |     39 |   100.00 | NULL                            |
|  2 | DERIVED     | PART       | eq_ref | PRIMARY                                                                        | PRIMARY             | 4       | tpch.PARTSUPP.ps_partkey                         |      1 |   100.00 | Using where                     |
|  2 | DERIVED     | LINEITEM   | ref    | i_l_partkey,i_l_orderkey,i_l_suppkey_partkey,i_l_suppkey,i_l_orderkey_quantity | i_l_suppkey_partkey | 10      | tpch.PARTSUPP.ps_partkey,tpch.SUPPLIER.s_suppkey |      3 |   100.00 | Using where                     |
|  2 | DERIVED     | ORDERS     | eq_ref | PRIMARY                                                                        | PRIMARY             | 4       | tpch.LINEITEM.l_orderkey                         |      1 |   100.00 | NULL                            |
+----+-------------+------------+--------+--------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+--------+----------+---------------------------------+
7 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `profit`.`NATION` AS `NATION`,`profit`.`O_YEAR` AS `O_YEAR`,sum(`profit`.`AMOUNT`) AS `SUM_PROFIT` from (/* select#2 */ select `tpch`.`nation`.`n_name` AS `NATION`,extract(year from `tpch`.`orders`.`o_orderDATE`) AS `O_YEAR`,((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) - (`tpch
`.`partsupp`.`ps_supplycost` * `tpch`.`lineitem`.`l_quantity`)) AS `AMOUNT` from `tpch`.`part` join `tpch`.`supplier` join `tpch`.`lineitem` join `tpch`.`partsupp` join `tpch`.`orders` join `tpch`.`nation` where ((`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`orders`.`o_orderkey` = `tpch`.`lineitem`.`l_orderkey`) and
 (`tpch`.`part`.`p_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`lineitem`.`l_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`partsupp`.`ps_suppkey` = `tpch`.`supplier`.`s_suppkey`) and (`tpch`.`lineitem`.`l_suppkey` = `tpch`.`supplier`.`s_suppkey`) and (`tpch`.`part`.`p_name` like '%GREEN%'))) `profit` group by `profit`.`NATION`,
`profit`.`O_YEAR` desc order by `profit`.`NATION`,`profit`.`O_YEAR` desc |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:45     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q10;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q10' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  C_CUSTKEY,
    ->  C_NAME,
    ->  SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
    ->  C_ACCTBAL,
    ->  N_NAME,
    ->  C_ADDRESS,
    ->  C_PHONE,
    ->  C_COMMENT
    -> FROM
    ->  CUSTOMER,
    ->  ORDERS,
    ->  LINEITEM,
    ->  NATION
    -> WHERE
    ->  C_CUSTKEY = O_CUSTKEY
    ->  AND L_ORDERKEY = O_ORDERKEY
    ->  AND O_ORDERDATE >= DATE '1993-10-01'
    ->  AND O_ORDERDATE < DATE '1993-10-01' + INTERVAL '3' MONTH
    ->  AND L_RETURNFLAG = 'R'
    ->  AND C_NATIONKEY = N_NATIONKEY
    -> GROUP BY
    ->  C_CUSTKEY,
    ->  C_NAME,
    ->  C_ACCTBAL,
    ->  C_PHONE,
    ->  N_NAME,
    ->  C_ADDRESS,
    ->  C_COMMENT
    -> ORDER BY
    ->  REVENUE DESC;
+----+-------------+----------+--------+------------------------------------+---------------+---------+---------------------------+--------+----------+--------------------------------------------------------------------------------+
| id | select_type | table    | type   | possible_keys                      | key           | key_len | ref                       | rows   | filtered | Extra                                                                          |
+----+-------------+----------+--------+------------------------------------+---------------+---------+---------------------------+--------+----------+--------------------------------------------------------------------------------+
|  1 | SIMPLE      | ORDERS   | range  | PRIMARY,i_o_orderdate,i_o_custkey  | i_o_orderdate | 4       | NULL                      | 118026 |   100.00 | Using index condition; Using where; Using MRR; Using temporary; Using filesort |
|  1 | SIMPLE      | CUSTOMER | eq_ref | PRIMARY,i_c_nationkey              | PRIMARY       | 4       | tpch.ORDERS.o_custkey     |      1 |   100.00 | Using where                                                                    |
|  1 | SIMPLE      | NATION   | eq_ref | PRIMARY                            | PRIMARY       | 4       | tpch.CUSTOMER.c_nationkey |      1 |   100.00 | NULL                                                                           |
|  1 | SIMPLE      | LINEITEM | ref    | i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey  | 5       | tpch.ORDERS.o_orderkey    |      1 |   100.00 | Using where                                                                    |
+----+-------------+----------+--------+------------------------------------+---------------+---------+---------------------------+--------+----------+--------------------------------------------------------------------------------+
4 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`customer`.`c_custkey` AS `C_CUSTKEY`,`tpch`.`customer`.`c_name` AS `C_NAME`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `REVENUE`,`tpch`.`customer`.`c_acctbal` AS `C_ACCTBAL`,`tpch`.`nation`.`n_name` AS `N_NAME`,`tpch`.`customer`.`c_address` AS `C_ADDRESS`,`tpch
`.`customer`.`c_phone` AS `C_PHONE`,`tpch`.`customer`.`c_comment` AS `C_COMMENT` from `tpch`.`customer` join `tpch`.`orders` join `tpch`.`lineitem` join `tpch`.`nation` where ((`tpch`.`nation`.`n_nationkey` = `tpch`.`customer`.`c_nationkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`customer`.`c_custkey` = `tp
ch`.`orders`.`o_custkey`) and (`tpch`.`orders`.`o_orderDATE` >= DATE'1993-10-01') and (`tpch`.`orders`.`o_orderDATE` < (DATE'1993-10-01' + interval '3' month)) and (`tpch`.`lineitem`.`l_returnflag` = 'R')) group by `tpch`.`customer`.`c_custkey`,`tpch`.`customer`.`c_name`,`tpch`.`customer`.`c_acctbal`,`tpch`.`customer`.`c_phone`,`tpch`.`nation`.`n_n
ame`,`tpch`.`customer`.`c_address`,`tpch`.`customer`.`c_comment` order by `REVENUE` desc |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:45     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q11;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q11' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  PS_PARTKEY,
    ->  SUM(PS_SUPPLYCOST * PS_AVAILQTY) AS VALUE
    -> FROM
    ->  PARTSUPP,
    ->  SUPPLIER,
    ->  NATION
    -> WHERE
    ->  PS_SUPPKEY = S_SUPPKEY
    ->  AND S_NATIONKEY = N_NATIONKEY
    ->  AND N_NAME = 'GERMANY'
    -> GROUP BY
    ->  PS_PARTKEY      HAVING
    ->          SUM(PS_SUPPLYCOST * PS_AVAILQTY) > (
    ->                  SELECT
    ->                          SUM(PS_SUPPLYCOST * PS_AVAILQTY) * 0.0001/1
    ->                  FROM
    ->                          PARTSUPP,
    ->                          SUPPLIER,
    ->                          NATION
    ->                  WHERE
    ->                          PS_SUPPKEY = S_SUPPKEY
    ->                          AND S_NATIONKEY = N_NATIONKEY
    ->                          AND N_NAME = 'GERMANY'
    ->          )
    -> ORDER BY
    ->  VALUE DESC;
+----+-------------+----------+------+-----------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
| id | select_type | table    | type | possible_keys         | key           | key_len | ref                     | rows | filtered | Extra                                        |
+----+-------------+----------+------+-----------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
|  1 | PRIMARY     | NATION   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |   25 |   100.00 | Using where; Using temporary; Using filesort |
|  1 | PRIMARY     | SUPPLIER | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | tpch.NATION.n_nationkey |  199 |   100.00 | Using index                                  |
|  1 | PRIMARY     | PARTSUPP | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | tpch.SUPPLIER.s_suppkey |   39 |   100.00 | NULL                                         |
|  2 | SUBQUERY    | NATION   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |   25 |   100.00 | Using where                                  |
|  2 | SUBQUERY    | SUPPLIER | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | tpch.NATION.n_nationkey |  199 |   100.00 | Using index                                  |
|  2 | SUBQUERY    | PARTSUPP | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | tpch.SUPPLIER.s_suppkey |   39 |   100.00 | NULL                                         |
+----+-------------+----------+------+-----------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
6 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                  |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`partsupp`.`ps_partkey` AS `PS_PARTKEY`,sum((`tpch`.`partsupp`.`ps_supplycost` * `tpch`.`partsupp`.`ps_availqty`)) AS `VALUE` from `tpch`.`partsupp` join `tpch`.`supplier` join `tpch`.`nation` where ((`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`partsupp`.`ps_suppkey` =
`tpch`.`supplier`.`s_suppkey`) and (`tpch`.`nation`.`n_name` = 'GERMANY')) group by `tpch`.`partsupp`.`ps_partkey` having (sum((`tpch`.`partsupp`.`ps_supplycost` * `tpch`.`partsupp`.`ps_availqty`)) > (/* select#2 */ select ((sum((`tpch`.`partsupp`.`ps_supplycost` * `tpch`.`partsupp`.`ps_availqty`)) * 0.0001) / 1) from `tpch`.`partsupp` join `tpch`.
`supplier` join `tpch`.`nation` where ((`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`partsupp`.`ps_suppkey` = `tpch`.`supplier`.`s_suppkey`) and (`tpch`.`nation`.`n_name` = 'GERMANY')))) order by `VALUE` desc |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:45     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q12;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q12' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  L_SHIPMODE,
    ->  SUM(CASE
    ->          WHEN O_ORDERPRIORITY = '1-URGENT'
    ->                  OR O_ORDERPRIORITY = '2-HIGH'
    ->          THEN 1
    ->          ELSE 0
    ->  END) AS HIGH_LINE_COUNT,
    ->  SUM(CASE
    ->          WHEN O_ORDERPRIORITY <> '1-URGENT'
    ->                  AND O_ORDERPRIORITY <> '2-HIGH'
    ->          THEN 1
    ->          ELSE 0
    ->  END) AS LOW_LINE_COUNT
    -> FROM
    ->  ORDERS,
    ->  LINEITEM
    -> WHERE
    ->  O_ORDERKEY = L_ORDERKEY
    ->  AND L_SHIPMODE IN ('MAIL', 'SHIP')
    ->  AND L_COMMITDATE < L_RECEIPTDATE
    ->  AND L_SHIPDATE < L_COMMITDATE
    ->  AND L_RECEIPTDATE >= DATE '1994-01-01'
    ->  AND L_RECEIPTDATE < DATE '1994-01-01' + INTERVAL '1' YEAR
    -> GROUP BY
    ->  L_SHIPMODE
    -> ORDER BY
    ->  L_SHIPMODE;
+----+-------------+----------+------+----------------------------------------------------+--------------+---------+------------------------+---------+----------+---------------------------------+
| id | select_type | table    | type | possible_keys                                      | key          | key_len | ref                    | rows    | filtered | Extra                           |
+----+-------------+----------+------+----------------------------------------------------+--------------+---------+------------------------+---------+----------+---------------------------------+
|  1 | SIMPLE      | ORDERS   | ALL  | PRIMARY                                            | NULL         | NULL    | NULL                   | 1491317 |   100.00 | Using temporary; Using filesort |
|  1 | SIMPLE      | LINEITEM | ref  | i_l_orderkey,i_l_receiptdate,i_l_orderkey_quantity | i_l_orderkey | 5       | tpch.ORDERS.o_orderkey |       1 |   100.00 | Using where                     |
+----+-------------+----------+------+----------------------------------------------------+--------------+---------+------------------------+---------+----------+---------------------------------+
2 rows in set, 1 warning (0.02 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                           |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`lineitem`.`l_shipmode` AS `L_SHIPMODE`,sum((case when ((`tpch`.`orders`.`o_orderpriority` = '1-URGENT') or (`tpch`.`orders`.`o_orderpriority` = '2-HIGH')) then 1 else 0 end)) AS `HIGH_LINE_COUNT`,sum((case when ((`tpch`.`orders`.`o_orderpriority` <> '1-URGENT') and (`tpch`.`orders`.`o_orderpriority` <>
 '2-HIGH')) then 1 else 0 end)) AS `LOW_LINE_COUNT` from `tpch`.`orders` join `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`lineitem`.`l_shipmode` in ('MAIL','SHIP')) and (`tpch`.`lineitem`.`l_commitDATE` < `tpch`.`lineitem`.`l_receiptDATE`) and (`tpch`.`lineitem`.`l_shipDATE` < `tpch`.`lineit
em`.`l_commitDATE`) and (`tpch`.`lineitem`.`l_receiptDATE` >= DATE'1994-01-01') and (`tpch`.`lineitem`.`l_receiptDATE` < <cache>((DATE'1994-01-01' + interval '1' year)))) group by `tpch`.`lineitem`.`l_shipmode` order by `tpch`.`lineitem`.`l_shipmode` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:46     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q13;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q13' at line 1
mysql> CREATE VIEW ORDERS_PER_CUSTS (CUSTKEY, ORDERCOUNT) AS
    ->     SELECT
    ->         C_CUSTKEY,
    ->         COUNT(O_ORDERKEY)
    ->     FROM
    ->         CUSTOMER LEFT OUTER JOIN ORDERS ON
    ->         C_CUSTKEY = O_CUSTKEY
    ->         AND O_COMMENT NOT LIKE '%SPECIAL%REQUESTS%'
    ->     GROUP BY
    ->         C_CUSTKEY;
Query OK, 0 rows affected (0.00 sec)

mysql>
mysql> EXPLAIN EXTENDED SELECT
    ->     ORDERCOUNT,
    ->     COUNT(*) AS CUSTDIST
    -> FROM
    ->     ORDERS_PER_CUSTS
    -> GROUP BY
    ->     ORDERCOUNT
    -> ORDER BY
    ->     CUSTDIST DESC,
    ->     ORDERCOUNT DESC;
+----+-------------+------------+-------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------+
| id | select_type | table      | type  | possible_keys | key         | key_len | ref                     | rows    | filtered | Extra                           |
+----+-------------+------------+-------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------+
|  1 | PRIMARY     | <derived2> | ALL   | NULL          | NULL        | NULL    | NULL                    | 1043476 |   100.00 | Using temporary; Using filesort |
|  2 | DERIVED     | customer   | index | NULL          | PRIMARY     | 4       | NULL                    |  149068 |   100.00 | Using index                     |
|  2 | DERIVED     | orders     | ref   | i_o_custkey   | i_o_custkey | 5       | tpch.customer.c_custkey |       7 |   100.00 | Using where                     |
+----+-------------+------------+-------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------+
3 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message                                                                                                                                                                                                                            |
+-------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `orders_per_custs`.`ORDERCOUNT` AS `ORDERCOUNT`,count(0) AS `CUSTDIST` from `tpch`.`orders_per_custs` group by `orders_per_custs`.`ORDERCOUNT` order by `CUSTDIST` desc,`orders_per_custs`.`ORDERCOUNT` desc |
+-------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.01 sec)

mysql>
mysql> DROP VIEW ORDERS_PER_CUSTS;
Query OK, 0 rows affected (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:46     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q14;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q14' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  100.00 * SUM(CASE
    ->          WHEN P_TYPE LIKE 'PROMO%'
    ->          THEN L_EXTENDEDPRICE * (1 - L_DISCOUNT)
    ->          ELSE 0
    ->  END) / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS PROMO_REVENUE
    -> FROM
    ->  LINEITEM,
    ->  PART
    -> WHERE
    ->  L_PARTKEY = P_PARTKEY
    ->  AND L_SHIPDATE >= DATE '1995-09-01'
    ->  AND L_SHIPDATE < DATE '1995-09-01' + INTERVAL '1' MONTH;
+----+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+--------+----------+-----------------------------------------------+
| id | select_type | table    | type   | possible_keys                                | key          | key_len | ref                     | rows   | filtered | Extra                                         |
+----+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+--------+----------+-----------------------------------------------+
|  1 | SIMPLE      | LINEITEM | range  | i_l_shipdate,i_l_partkey,i_l_suppkey_partkey | i_l_shipdate | 4       | NULL                    | 158472 |   100.00 | Using index condition; Using where; Using MRR |
|  1 | SIMPLE      | PART     | eq_ref | PRIMARY                                      | PRIMARY      | 4       | tpch.LINEITEM.l_partkey |      1 |   100.00 | NULL                                          |
+----+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+--------+----------+-----------------------------------------------+
2 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message
                                                                                                                                                                                                        |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select ((100.00 * sum((case when (`tpch`.`part`.`p_type` like 'PROMO%') then (`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) else 0 end))) / sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)))) AS `PROMO_REVENUE` from `tpch`.`lineitem` join `tpch`.`part` wher
e ((`tpch`.`part`.`p_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`lineitem`.`l_shipDATE` >= DATE'1995-09-01') and (`tpch`.`lineitem`.`l_shipDATE` < (DATE'1995-09-01' + interval '1' month))) |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:46     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q15;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q15' at line 1
mysql> CREATE VIEW REVENUE0 (SUPPLIER_NO, TOTAL_REVENUE) AS
    ->  SELECT
    ->          L_SUPPKEY,
    ->          SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
    ->  FROM LINEITEM
    ->  WHERE
    ->          L_SHIPDATE >= DATE'1996-01-01'
    ->          AND L_SHIPDATE < DATE'1996-01-01' + INTERVAL '3' MONTH
    ->  GROUP BY
    ->          L_SUPPKEY;
Query OK, 0 rows affected (0.02 sec)

mysql>
mysql> EXPLAIN EXTENDED SELECT
    ->  S_SUPPKEY,
    ->  S_NAME,
    ->  S_ADDRESS,
    ->  S_PHONE,
    ->  TOTAL_REVENUE
    -> FROM
    ->  SUPPLIER,
    ->  REVENUE0
    -> WHERE
    ->  S_SUPPKEY = SUPPLIER_NO
    ->  AND TOTAL_REVENUE = (
    ->          SELECT
    ->                  MAX(TOTAL_REVENUE)
    ->          FROM REVENUE0
    ->  )
    -> ORDER BY
    ->  S_SUPPKEY;
+----+-------------+------------+--------+---------------+--------------+---------+----------------------+--------+----------+-------------------------------------------------------------------+
| id | select_type | table      | type   | possible_keys | key          | key_len | ref                  | rows   | filtered | Extra                                                             |
+----+-------------+------------+--------+---------------+--------------+---------+----------------------+--------+----------+-------------------------------------------------------------------+
|  1 | PRIMARY     | <derived3> | ALL    | NULL          | NULL         | NULL    | NULL                 | 477816 |    75.00 | Using where; Using temporary; Using filesort                      |
|  1 | PRIMARY     | SUPPLIER   | eq_ref | PRIMARY       | PRIMARY      | 4       | REVENUE0.SUPPLIER_NO |      1 |   100.00 | NULL                                                              |
|  3 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 477816 |   100.00 | Using index condition; Using MRR; Using temporary; Using filesort |
|  2 | SUBQUERY    | <derived4> | ALL    | NULL          | NULL         | NULL    | NULL                 | 477816 |   100.00 | NULL                                                              |
|  4 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 477816 |   100.00 | Using index condition; Using MRR; Using temporary; Using filesort |
+----+-------------+------------+--------+---------------+--------------+---------+----------------------+--------+----------+-------------------------------------------------------------------+
5 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message
                                                                                                                                                                           |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`supplier`.`s_suppkey` AS `S_SUPPKEY`,`tpch`.`supplier`.`s_name` AS `S_NAME`,`tpch`.`supplier`.`s_address` AS `S_ADDRESS`,`tpch`.`supplier`.`s_phone` AS `S_PHONE`,`revenue0`.`TOTAL_REVENUE` AS `TOTAL_REVENUE` from `tpch`.`supplier` join `tpch`.`revenue0` where ((`tpch`.`supplier`.`s_suppkey` = `revenue0
`.`SUPPLIER_NO`) and (`revenue0`.`TOTAL_REVENUE` = (/* select#2 */ select max(`revenue0`.`TOTAL_REVENUE`) from `tpch`.`revenue0`))) order by `tpch`.`supplier`.`s_suppkey` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql>
mysql> DROP VIEW REVENUE0;
Query OK, 0 rows affected (0.02 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:47     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q16;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q16' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  P_BRAND,
    ->  P_TYPE,
    ->  P_SIZE,
    ->  COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT
    -> FROM
    ->  PARTSUPP,
    ->  PART
    -> WHERE
    ->  P_PARTKEY = PS_PARTKEY
    ->  AND P_BRAND <> 'BRAND#45'
    ->  AND P_TYPE NOT LIKE 'MEDIUM POLISHED%'
    ->  AND P_SIZE IN (49, 14, 23, 45, 19, 3, 36, 9)
    ->  AND PS_SUPPKEY NOT IN (
    ->          SELECT
    ->                  S_SUPPKEY
    ->          FROM
    ->                  SUPPLIER
    ->          WHERE
    ->                  S_COMMENT LIKE '%CUSTOMER%COMPLAINTS%'
    ->  )
    -> GROUP BY
    ->  P_BRAND,
    ->  P_TYPE,
    ->  P_SIZE
    -> ORDER BY
    ->  SUPPLIER_CNT DESC,
    ->  P_BRAND,
    ->  P_TYPE,
    ->  P_SIZE;
+----+-------------+----------+------+----------------------+---------+---------+---------------------+--------+----------+----------------------------------------------+
| id | select_type | table    | type | possible_keys        | key     | key_len | ref                 | rows   | filtered | Extra                                        |
+----+-------------+----------+------+----------------------+---------+---------+---------------------+--------+----------+----------------------------------------------+
|  1 | PRIMARY     | PART     | ALL  | PRIMARY              | NULL    | NULL    | NULL                | 198229 |   100.00 | Using where; Using temporary; Using filesort |
|  1 | PRIMARY     | PARTSUPP | ref  | PRIMARY,i_ps_partkey | PRIMARY | 4       | tpch.PART.p_partkey |      1 |   100.00 | Using where; Using index                     |
|  2 | SUBQUERY    | SUPPLIER | ALL  | PRIMARY              | NULL    | NULL    | NULL                |   9967 |   100.00 | Using where                                  |
+----+-------------+----------+------+----------------------+---------+---------+---------------------+--------+----------+----------------------------------------------+
3 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`part`.`p_brand` AS `P_BRAND`,`tpch`.`part`.`p_type` AS `P_TYPE`,`tpch`.`part`.`p_size` AS `P_SIZE`,count(distinct `tpch`.`partsupp`.`ps_suppkey`) AS `SUPPLIER_CNT` from `tpch`.`partsupp` join `tpch`.`part` where ((`tpch`.`partsupp`.`ps_partkey` = `tpch`.`part`.`p_partkey`) and (`tpch`.`part`.`p_brand`
<> 'BRAND#45') and (not((`tpch`.`part`.`p_type` like 'MEDIUM POLISHED%'))) and (`tpch`.`part`.`p_size` in (49,14,23,45,19,3,36,9)) and (not(<in_optimizer>(`tpch`.`partsupp`.`ps_suppkey`,`tpch`.`partsupp`.`ps_suppkey` in ( <materialize> (/* select#2 */ select `tpch`.`supplier`.`s_suppkey` from `tpch`.`supplier` where (`tpch`.`supplier`.`s_comment` l
ike '%CUSTOMER%COMPLAINTS%') ), <primary_index_lookup>(`tpch`.`partsupp`.`ps_suppkey` in <temporary table> on <auto_key> where ((`tpch`.`partsupp`.`ps_suppkey` = `materialized-subquery`.`S_SUPPKEY`)))))))) group by `tpch`.`part`.`p_brand`,`tpch`.`part`.`p_type`,`tpch`.`part`.`p_size` order by `SUPPLIER_CNT` desc,`tpch`.`part`.`p_brand`,`tpch`.`part
`.`p_type`,`tpch`.`part`.`p_size` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:47     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q17;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q17' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  SUM(L_EXTENDEDPRICE) / 7.0 AS AVG_YEARLY
    -> FROM
    ->  LINEITEM,
    ->  PART
    -> WHERE
    ->  P_PARTKEY = L_PARTKEY
    ->  AND P_BRAND = 'BRAND#23'
    ->  AND P_CONTAINER = 'MED BOX'
    ->  AND L_QUANTITY < (
    ->          SELECT
    ->                  0.2 * AVG(L_QUANTITY)
    ->          FROM
    ->                  LINEITEM
    ->          WHERE L_PARTKEY = P_PARTKEY
    ->  );
+----+--------------------+----------+------+---------------------------------+-------------+---------+---------------------+--------+----------+-------------+
| id | select_type        | table    | type | possible_keys                   | key         | key_len | ref                 | rows   | filtered | Extra       |
+----+--------------------+----------+------+---------------------------------+-------------+---------+---------------------+--------+----------+-------------+
|  1 | PRIMARY            | PART     | ALL  | PRIMARY                         | NULL        | NULL    | NULL                | 198229 |   100.00 | Using where |
|  1 | PRIMARY            | LINEITEM | ref  | i_l_partkey,i_l_suppkey_partkey | i_l_partkey | 5       | tpch.PART.p_partkey |     14 |   100.00 | Using where |
|  2 | DEPENDENT SUBQUERY | LINEITEM | ref  | i_l_partkey,i_l_suppkey_partkey | i_l_partkey | 5       | tpch.PART.p_partkey |     14 |   100.00 | NULL        |
+----+--------------------+----------+------+---------------------------------+-------------+---------+---------------------+--------+----------+-------------+
3 rows in set, 2 warnings (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message
                                                                                                                                                     |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1276 | Field or reference 'tpch.PART.p_partkey' of SELECT #2 was resolved in SELECT #1
                                                                                                                                                     |
| Note  | 1003 | /* select#1 */ select (sum(`tpch`.`lineitem`.`l_extendedprice`) / 7.0) AS `AVG_YEARLY` from `tpch`.`lineitem` join `tpch`.`part` where ((`tpch`.`lineitem`.`l_partkey` = `tpch`.`part`.`p_partkey`) and (`tpch`.`part`.`p_brand` = 'BRAND#23') and (`tpch`.`part`.`p_container` = 'MED BOX') and (`tpch`.`lineitem`.`l_quantity` < (/* select
#2 */ select (0.2 * avg(`tpch`.`lineitem`.`l_quantity`)) from `tpch`.`lineitem` where (`tpch`.`lineitem`.`l_partkey` = `tpch`.`part`.`p_partkey`)))) |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:47     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q18;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q18' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  C_NAME,
    ->  C_CUSTKEY,
    ->  O_ORDERKEY,
    ->  O_ORDERDATE,
    ->  O_TOTALPRICE,
    ->  SUM(L_QUANTITY)
    -> FROM
    ->  CUSTOMER,
    ->  ORDERS,
    ->  LINEITEM
    -> WHERE
    ->  O_ORDERKEY IN (
    ->          SELECT
    ->                  L_ORDERKEY
    ->          FROM
    ->                  LINEITEM
    ->          GROUP BY
    ->                  L_ORDERKEY HAVING
    ->                          SUM(L_QUANTITY) > 300
    ->  )
    ->  AND C_CUSTKEY = O_CUSTKEY
    ->  AND O_ORDERKEY = L_ORDERKEY
    -> GROUP BY
    ->  C_NAME,
    ->  C_CUSTKEY,
    ->  O_ORDERKEY,
    ->  O_ORDERDATE,
    ->  O_TOTALPRICE
    -> ORDER BY
    ->  O_TOTALPRICE DESC,
    ->  O_ORDERDATE ;
+----+-------------+----------+-------+------------------------------------+--------------+---------+-------------------------+---------+----------+---------------------------------+
| id | select_type | table    | type  | possible_keys                      | key          | key_len | ref                     | rows    | filtered | Extra                           |
+----+-------------+----------+-------+------------------------------------+--------------+---------+-------------------------+---------+----------+---------------------------------+
|  1 | PRIMARY     | CUSTOMER | ALL   | PRIMARY                            | NULL         | NULL    | NULL                    |  149068 |   100.00 | Using temporary; Using filesort |
|  1 | PRIMARY     | ORDERS   | ref   | PRIMARY,i_o_custkey                | i_o_custkey  | 5       | tpch.CUSTOMER.c_custkey |       7 |   100.00 | Using where                     |
|  1 | PRIMARY     | LINEITEM | ref   | i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey | 5       | tpch.ORDERS.o_orderkey  |       1 |   100.00 | NULL                            |
|  2 | SUBQUERY    | LINEITEM | index | NULL                               | i_l_orderkey | 5       | NULL                    | 5947760 |   100.00 | NULL                            |
+----+-------------+----------+-------+------------------------------------+--------------+---------+-------------------------+---------+----------+---------------------------------+
4 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select `tpch`.`customer`.`c_name` AS `C_NAME`,`tpch`.`customer`.`c_custkey` AS `C_CUSTKEY`,`tpch`.`orders`.`o_orderkey` AS `O_ORDERKEY`,`tpch`.`orders`.`o_orderDATE` AS `O_ORDERDATE`,`tpch`.`orders`.`o_totalprice` AS `O_TOTALPRICE`,sum(`tpch`.`lineitem`.`l_quantity`) AS `SUM(L_QUANTITY)` from `tpch`.`customer` join `
tpch`.`orders` join `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`orders`.`o_custkey` = `tpch`.`customer`.`c_custkey`) and <in_optimizer>(`tpch`.`orders`.`o_orderkey`,`tpch`.`orders`.`o_orderkey` in ( <materialize> (/* select#2 */ select `tpch`.`lineitem`.`l_orderkey` from `tpch`.`lineitem` gr
oup by `tpch`.`lineitem`.`l_orderkey` having (sum(`tpch`.`lineitem`.`l_quantity`) > 300) ), <primary_index_lookup>(`tpch`.`orders`.`o_orderkey` in <temporary table> on <auto_key> where ((`tpch`.`orders`.`o_orderkey` = `materialized-subquery`.`L_ORDERKEY`)))))) group by `tpch`.`customer`.`c_name`,`tpch`.`customer`.`c_custkey`,`tpch`.`orders`.`o_orde
rkey`,`tpch`.`orders`.`o_orderDATE`,`tpch`.`orders`.`o_totalprice` order by `tpch`.`orders`.`o_totalprice` desc,`tpch`.`orders`.`o_orderDATE` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:48     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q19;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q19' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  SUM(L_EXTENDEDPRICE* (1 - L_DISCOUNT)) AS REVENUE
    -> FROM
    ->  LINEITEM,
    ->  PART
    -> WHERE
    ->  (
    ->          P_PARTKEY = L_PARTKEY
    ->          AND P_BRAND = 'BRAND#12'
    ->          AND P_CONTAINER IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
    ->          AND L_QUANTITY >= 1     AND L_QUANTITY <= 1+10
    ->          AND P_SIZE BETWEEN 1 AND 5
    ->          AND L_SHIPMODE IN ('AIR', 'AIR REG')
    ->          AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
    ->  )
    ->  OR
    ->  (
    ->          P_PARTKEY = L_PARTKEY
    ->          AND P_BRAND = 'BRAND#23'
    ->          AND P_CONTAINER IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
    ->          AND L_QUANTITY >= 10 AND L_QUANTITY <= 10+10
    ->          AND P_SIZE BETWEEN 1 AND 10
    ->          AND L_SHIPMODE IN ('AIR', 'AIR REG')
    ->          AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
    ->  )
    ->  OR
    ->  (
    ->          P_PARTKEY = L_PARTKEY
    ->          AND P_BRAND = 'BRAND#34'
    ->          AND P_CONTAINER IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
    ->          AND L_QUANTITY >= 20 AND L_QUANTITY <= 20+10
    ->          AND P_SIZE BETWEEN 1 AND 15
    ->          AND L_SHIPMODE IN ('AIR', 'AIR REG')
    ->          AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
    ->  );
+----+-------------+----------+------+---------------------------------+-------------+---------+---------------------+--------+----------+------------------------------------+
| id | select_type | table    | type | possible_keys                   | key         | key_len | ref                 | rows   | filtered | Extra                              |
+----+-------------+----------+------+---------------------------------+-------------+---------+---------------------+--------+----------+------------------------------------+
|  1 | SIMPLE      | PART     | ALL  | PRIMARY                         | NULL        | NULL    | NULL                | 198229 |   100.00 | Using where                        |
|  1 | SIMPLE      | LINEITEM | ref  | i_l_partkey,i_l_suppkey_partkey | i_l_partkey | 5       | tpch.PART.p_partkey |     14 |   100.00 | Using index condition; Using where |
+----+-------------+----------+------+---------------------------------+-------------+---------+---------------------+--------+----------+------------------------------------+
2 rows in set, 1 warning (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1003 | /* select#1 */ select sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `REVENUE` from `tpch`.`lineitem` join `tpch`.`part` where (((`tpch`.`lineitem`.`l_partkey` = `tpch`.`part`.`p_partkey`) and (`tpch`.`part`.`p_brand` = 'BRAND#12') and (`tpch`.`part`.`p_container` in ('SM CASE','SM BOX','SM PAC
K','SM PKG')) and (`tpch`.`lineitem`.`l_quantity` >= 1) and (`tpch`.`lineitem`.`l_quantity` <= <cache>((1 + 10))) and (`tpch`.`part`.`p_size` between 1 and 5) and (`tpch`.`lineitem`.`l_shipmode` in ('AIR','AIR REG')) and (`tpch`.`lineitem`.`l_shipinstruct` = 'DELIVER IN PERSON')) or ((`tpch`.`lineitem`.`l_partkey` = `tpch`.`part`.`p_partkey`) and (
`tpch`.`part`.`p_brand` = 'BRAND#23') and (`tpch`.`part`.`p_container` in ('MED BAG','MED BOX','MED PKG','MED PACK')) and (`tpch`.`lineitem`.`l_quantity` >= 10) and (`tpch`.`lineitem`.`l_quantity` <= <cache>((10 + 10))) and (`tpch`.`part`.`p_size` between 1 and 10) and (`tpch`.`lineitem`.`l_shipmode` in ('AIR','AIR REG')) and (`tpch`.`lineitem`.`l_
shipinstruct` = 'DELIVER IN PERSON')) or ((`tpch`.`lineitem`.`l_partkey` = `tpch`.`part`.`p_partkey`) and (`tpch`.`part`.`p_brand` = 'BRAND#34') and (`tpch`.`part`.`p_container` in ('LG CASE','LG BOX','LG PACK','LG PKG')) and (`tpch`.`lineitem`.`l_quantity` >= 20) and (`tpch`.`lineitem`.`l_quantity` <= <cache>((20 + 10))) and (`tpch`.`part`.`p_size
` between 1 and 15) and (`tpch`.`lineitem`.`l_shipmode` in ('AIR','AIR REG')) and (`tpch`.`lineitem`.`l_shipinstruct` = 'DELIVER IN PERSON'))) |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:48     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q20;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q20' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  S_NAME,
    ->  S_ADDRESS
    -> FROM
    ->  SUPPLIER, NATION
    -> WHERE
    ->  S_SUPPKEY IN (
    ->          SELECT
    ->                  PS_SUPPKEY
    ->          FROM
    ->                  PARTSUPP
    ->          WHERE
    ->                  PS_PARTKEY IN (
    ->                          SELECT
    ->                                  P_PARTKEY
    ->                          FROM
    ->                                  PART
    ->                          WHERE
    ->                                  P_NAME LIKE 'FOREST%'
    ->                  )
    ->          AND PS_AVAILQTY > (
    ->                  SELECT
    ->                          0.5 * SUM(L_QUANTITY)
    ->                  FROM
    ->                          LINEITEM
    ->                  WHERE
    ->                          L_PARTKEY = PS_PARTKEY
    ->                          AND L_SUPPKEY = PS_SUPPKEY
    ->                          AND L_SHIPDATE >= DATE '1994-01-01'
    ->                          AND L_SHIPDATE < DATE '1994-01-01' + INTERVAL '1' YEAR
    ->          )
    ->  )
    ->  AND S_NATIONKEY = N_NATIONKEY
    ->  AND N_NAME = 'CANADA'
    -> ORDER BY
    ->  S_NAME;
+----+--------------------+----------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+------+----------+----------------------------------------------------------------------------+
| id | select_type        | table    | type   | possible_keys                                            | key                 | key_len | ref                                               | rows | filtered | Extra                                                                      |
+----+--------------------+----------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+------+----------+----------------------------------------------------------------------------+
|  1 | PRIMARY            | PART     | range  | PRIMARY,i_p_name                                         | i_p_name            | 168     | NULL                                              | 2387 |   100.00 | Using where; Using index; Using temporary; Using filesort; Start temporary |
|  1 | PRIMARY            | PARTSUPP | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                        | PRIMARY             | 4       | tpch.PART.p_partkey                               |    1 |   100.00 | Using where                                                                |
|  1 | PRIMARY            | SUPPLIER | eq_ref | PRIMARY,i_s_nationkey                                    | PRIMARY             | 4       | tpch.PARTSUPP.ps_suppkey                          |    1 |   100.00 | End temporary                                                              |
|  1 | PRIMARY            | NATION   | ALL    | PRIMARY                                                  | NULL                | NULL    | NULL                                              |   25 |    76.00 | Using where; Using join buffer (Block Nested Loop)                         |
|  4 | DEPENDENT SUBQUERY | LINEITEM | ref    | i_l_shipdate,i_l_partkey,i_l_suppkey_partkey,i_l_suppkey | i_l_suppkey_partkey | 10      | tpch.PARTSUPP.ps_partkey,tpch.PARTSUPP.ps_suppkey |    3 |   100.00 | Using where                                                                |
+----+--------------------+----------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+------+----------+----------------------------------------------------------------------------+
5 rows in set, 3 warnings (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                       |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1276 | Field or reference 'tpch.PARTSUPP.ps_partkey' of SELECT #4 was resolved in SELECT #2

                                                                                                                                                                                                                                                                       |
| Note  | 1276 | Field or reference 'tpch.PARTSUPP.ps_suppkey' of SELECT #4 was resolved in SELECT #2

                                                                                                                                                                                                                                                                       |
| Note  | 1003 | /* select#1 */ select `tpch`.`supplier`.`s_name` AS `S_NAME`,`tpch`.`supplier`.`s_address` AS `S_ADDRESS` from `tpch`.`supplier` semi join (`tpch`.`part` join `tpch`.`partsupp`) join `tpch`.`nation` where ((`tpch`.`supplier`.`s_suppkey` = `tpch`.`partsupp`.`ps_suppkey`) and (`tpch`.`partsupp`.`ps_partkey` = `tpch`.`part`.`p_partkey
`) and (`tpch`.`nation`.`n_nationkey` = `tpch`.`supplier`.`s_nationkey`) and (`tpch`.`nation`.`n_name` = 'CANADA') and (`tpch`.`partsupp`.`ps_availqty` > (/* select#4 */ select (0.5 * sum(`tpch`.`lineitem`.`l_quantity`)) from `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`lineitem`.`l_suppkey`
 = `tpch`.`partsupp`.`ps_suppkey`) and (`tpch`.`lineitem`.`l_shipDATE` >= DATE'1994-01-01') and (`tpch`.`lineitem`.`l_shipDATE` < <cache>((DATE'1994-01-01' + interval '1' year)))))) and (`tpch`.`part`.`p_name` like 'FOREST%')) order by `tpch`.`supplier`.`s_name` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
3 rows in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:48     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q21;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q21' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  S_NAME,
    ->  COUNT(*) AS NUMWAIT
    -> FROM
    ->  SUPPLIER,
    ->  LINEITEM L1,
    ->  ORDERS,
    ->  NATION
    -> WHERE
    ->  S_SUPPKEY = L1.L_SUPPKEY
    ->  AND O_ORDERKEY = L1.L_ORDERKEY
    ->  AND O_ORDERSTATUS = 'F'
    ->  AND L1.L_RECEIPTDATE > L1.L_COMMITDATE
    ->  AND EXISTS (
    ->          SELECT
    ->                  *
    ->          FROM
    ->                  LINEITEM L2
    ->          WHERE
    ->                  L2.L_ORDERKEY = L1.L_ORDERKEY
    ->                  AND L2.L_SUPPKEY <> L1.L_SUPPKEY
    ->  )
    ->  AND NOT EXISTS(
    ->          SELECT
    ->                  *
    ->          FROM
    ->                  LINEITEM L3
    ->          WHERE
    ->                  L3.L_ORDERKEY = L1.L_ORDERKEY
    ->                  AND L3.L_SUPPKEY <> L1.L_SUPPKEY
    ->                  AND L3.L_RECEIPTDATE > L3.L_COMMITDATE
    ->  )
    ->  AND S_NATIONKEY = N_NATIONKEY
    ->  AND N_NAME = 'SAUDI ARABIA'
    -> GROUP BY
    ->  S_NAME
    -> ORDER BY
    ->  NUMWAIT DESC,
    ->  S_NAME ;
+----+--------------------+----------+--------+------------------------------------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
| id | select_type        | table    | type   | possible_keys                                  | key           | key_len | ref                     | rows | filtered | Extra                                        |
+----+--------------------+----------+--------+------------------------------------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
|  1 | PRIMARY            | NATION   | ALL    | PRIMARY                                        | NULL          | NULL    | NULL                    |   25 |   100.00 | Using where; Using temporary; Using filesort |
|  1 | PRIMARY            | SUPPLIER | ref    | PRIMARY,i_s_nationkey                          | i_s_nationkey | 5       | tpch.NATION.n_nationkey |  199 |   100.00 | NULL                                         |
|  1 | PRIMARY            | L1       | ref    | i_l_orderkey,i_l_suppkey,i_l_orderkey_quantity | i_l_suppkey   | 5       | tpch.SUPPLIER.s_suppkey |  270 |   100.00 | Using where                                  |
|  1 | PRIMARY            | ORDERS   | eq_ref | PRIMARY                                        | PRIMARY       | 4       | tpch.L1.l_orderkey      |    1 |   100.00 | Using where                                  |
|  3 | DEPENDENT SUBQUERY | L3       | ref    | i_l_orderkey,i_l_orderkey_quantity             | i_l_orderkey  | 5       | tpch.L1.l_orderkey      |    1 |   100.00 | Using where                                  |
|  2 | DEPENDENT SUBQUERY | L2       | ref    | i_l_orderkey,i_l_orderkey_quantity             | i_l_orderkey  | 5       | tpch.L1.l_orderkey      |    1 |   100.00 | Using where                                  |
+----+--------------------+----------+--------+------------------------------------------------+---------------+---------+-------------------------+------+----------+----------------------------------------------+
6 rows in set, 5 warnings (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------+
| Level | Code | Message

                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------+
| Note  | 1276 | Field or reference 'tpch.L1.l_orderkey' of SELECT #2 was resolved in SELECT #1

                                                                                                                                                                                                                                                                                                                                                      |
| Note  | 1276 | Field or reference 'tpch.L1.l_suppkey' of SELECT #2 was resolved in SELECT #1

                                                                                                                                                                                                                                                                                                                                                      |
| Note  | 1276 | Field or reference 'tpch.L1.l_orderkey' of SELECT #3 was resolved in SELECT #1

                                                                                                                                                                                                                                                                                                                                                      |
| Note  | 1276 | Field or reference 'tpch.L1.l_suppkey' of SELECT #3 was resolved in SELECT #1

                                                                                                                                                                                                                                                                                                                                                      |
| Note  | 1003 | /* select#1 */ select `tpch`.`supplier`.`s_name` AS `S_NAME`,count(0) AS `NUMWAIT` from `tpch`.`supplier` join `tpch`.`lineitem` `l1` join `tpch`.`orders` join `tpch`.`nation` where ((`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`orders`.`o_orderkey` = `tpch`.`l1`.`l_orderkey`) and (`tpch`.`l1`.`l_su
ppkey` = `tpch`.`supplier`.`s_suppkey`) and (`tpch`.`orders`.`o_orderstatus` = 'F') and (`tpch`.`l1`.`l_receiptDATE` > `tpch`.`l1`.`l_commitDATE`) and exists(/* select#2 */ select 1 from `tpch`.`lineitem` `l2` where ((`tpch`.`l2`.`l_orderkey` = `tpch`.`l1`.`l_orderkey`) and (`tpch`.`l2`.`l_suppkey` <> `tpch`.`l1`.`l_suppkey`))) and (not(exists(/* s
elect#3 */ select 1 from `tpch`.`lineitem` `l3` where ((`tpch`.`l3`.`l_orderkey` = `tpch`.`l1`.`l_orderkey`) and (`tpch`.`l3`.`l_suppkey` <> `tpch`.`l1`.`l_suppkey`) and (`tpch`.`l3`.`l_receiptDATE` > `tpch`.`l3`.`l_commitDATE`))))) and (`tpch`.`nation`.`n_name` = 'SAUDI ARABIA')) group by `tpch`.`supplier`.`s_name` order by `NUMWAIT` desc,`tpch`.`
supplier`.`s_name` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------+
5 rows in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:49     |
+--------------+
1 row in set (0.00 sec)

mysql>
mysql> --Q22;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--Q22' at line 1
mysql> EXPLAIN EXTENDED SELECT
    ->  CNTRYCODE,
    ->  COUNT(*) AS NUMCUST,
    ->  SUM(C_ACCTBAL) AS TOTACCTBAL
    -> FROM (
    ->  SELECT
    ->          SUBSTR(C_PHONE, 1, 2) AS CNTRYCODE,
    ->          C_ACCTBAL
    ->  FROM
    ->          CUSTOMER
    ->  WHERE
    ->          SUBSTR(C_PHONE, 1, 2) IN
    ->                  ('13', '31', '23', '29', '30', '18', '17')
    ->          AND C_ACCTBAL > (
    ->                  SELECT
    ->                          AVG(C_ACCTBAL)
    ->                  FROM
    ->                          CUSTOMER
    ->                  WHERE
    ->                          C_ACCTBAL > 0.00
    ->                          AND SUBSTR(C_PHONE, 1, 2) IN
    ->                                  ('13', '31', '23', '29', '30', '18', '17')
    ->          )
    ->          AND NOT EXISTS (
    ->                  SELECT
    ->                          *
    ->                  FROM
    ->                          ORDERS
    ->                  WHERE
    ->                          O_CUSTKEY = C_CUSTKEY
    ->                  )
    ->  ) AS CUSTSALE
    -> GROUP BY
    ->  CNTRYCODE
    -> ORDER BY
    ->  CNTRYCODE;
+----+--------------------+------------+------+---------------+-------------+---------+-------------------------+--------+----------+---------------------------------+
| id | select_type        | table      | type | possible_keys | key         | key_len | ref                     | rows   | filtered | Extra                           |
+----+--------------------+------------+------+---------------+-------------+---------+-------------------------+--------+----------+---------------------------------+
|  1 | PRIMARY            | <derived2> | ALL  | NULL          | NULL        | NULL    | NULL                    | 149068 |   100.00 | Using temporary; Using filesort |
|  2 | DERIVED            | CUSTOMER   | ALL  | i_c_acctbal   | NULL        | NULL    | NULL                    | 149068 |   100.00 | Using where                     |
|  4 | DEPENDENT SUBQUERY | ORDERS     | ref  | i_o_custkey   | i_o_custkey | 5       | tpch.CUSTOMER.c_custkey |      7 |   100.00 | Using index                     |
|  3 | SUBQUERY           | CUSTOMER   | ALL  | i_c_acctbal   | NULL        | NULL    | NULL                    | 149068 |    50.00 | Using where                     |
+----+--------------------+------------+------+---------------+-------------+---------+-------------------------+--------+----------+---------------------------------+
4 rows in set, 2 warnings (0.00 sec)

mysql>
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message

                                                                                                                                                 |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------+
| Note  | 1276 | Field or reference 'tpch.CUSTOMER.c_custkey' of SELECT #4 was resolved in SELECT #2

                                                                                                                                                 |
| Note  | 1003 | /* select#1 */ select `custsale`.`CNTRYCODE` AS `CNTRYCODE`,count(0) AS `NUMCUST`,sum(`custsale`.`C_ACCTBAL`) AS `TOTACCTBAL` from (/* select#2 */ select substr(`tpch`.`customer`.`c_phone`,1,2) AS `CNTRYCODE`,`tpch`.`customer`.`c_acctbal` AS `C_ACCTBAL` from `tpch`.`customer` where ((substr(`tpch`.`customer`.`c_phone`,1,2) in ('13'
,'31','23','29','30','18','17')) and (`tpch`.`customer`.`c_acctbal` > (/* select#3 */ select avg(`tpch`.`customer`.`c_acctbal`) from `tpch`.`customer` where ((`tpch`.`customer`.`c_acctbal` > 0.00) and (substr(`tpch`.`customer`.`c_phone`,1,2) in ('13','31','23','29','30','18','17'))))) and (not(exists(/* select#4 */ select 1 from `tpch`.`orders` whe
re (`tpch`.`orders`.`o_custkey` = `tpch`.`customer`.`c_custkey`)))))) `custsale` group by `custsale`.`CNTRYCODE` order by `custsale`.`CNTRYCODE` |
+-------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)

mysql> SELECT current_time;
+--------------+
| current_time |
+--------------+
| 17:36:49     |
+--------------+
1 row in set (0.00 sec)

mysql>
